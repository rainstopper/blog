(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{387:function(e,t,o){},531:function(e,t,o){"use strict";o(387)},536:function(e,t,o){"use strict";o.r(t);o(106),o(105),o(478),o(509),o(381),o(513),o(527);var a={isEmpty:e=>null==e||""===e||0===e.length,isNotEmpty(e){return!this.isEmpty(e)}};const r={edgeLength:50,repulsion:50,gravity:.05};var s={name:"knowledge-graph",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},title:{type:String,default:"知识图谱"},nodes:{type:Array,default:()=>[]},edges:{type:Array,default:()=>[]},loading:Boolean,legends:Array,sortLegends:{type:Boolean,default:!1},categoryOther:{type:String,default:"其它"},minNodeSize:{type:Number,default:10},maxNodeSize:{type:Number,default:50},nodeSizeStep:{type:Number,default:1},minNodeOpacity:{type:Number,default:.5},maxNodeOpacity:{type:Number,default:1},maxNodeOpacityDegree:{type:Number,default:10},nodeOpacityIndex:{type:Number,default:1},nodeVisibleDegree:{type:Number,default:1},nodeLabelVisibleDegree:{type:Number,default:1},color:{type:Array,default:()=>["#338fcc","#2bb3d5","#33ccae","#fedca9","#fab36f","#d96d6f","#ff88b8"]},linkEdgeColor:{type:String,default:"#3eaf7c"},force:{type:Object,default:()=>({})},focusNodeAdjacency:{type:Boolean,default:!1}},data:()=>({search:{keyword:"",showOptions:!1,timer:null}}),computed:{option(){const{title:e,_legends:t,force:o,focusNodeAdjacency:s,categories:i,_nodes:n,_edges:l}=this;return{title:{text:e,top:8,left:8},legend:{type:"scroll",top:a.isNotEmpty(e)?36:0,left:8,orient:"vertical",data:t},tooltip:{formatter({dataType:e,data:t={}}={}){const{name:o,source:a,value:r,target:s,description:i,link:n}=t;let l={node:`${o}（关联 ${r} 个节点）`,edge:`${a} ${r} ${s}`}[e]||"";return i&&(l+=`${l.length?"<br/>":""}${i.replace(/\n/g,"<br/>")}`),n&&(l+=(l.length?"<br/>":"")+"点击查看详情"),l}},series:[{type:"graph",layout:"force",force:Object.assign({},r,o),roam:!0,draggable:!0,focusNodeAdjacency:s,itemStyle:{borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},label:{position:"right",distance:3,formatter:"{b}"},edgeLabel:{formatter:"{c}"},emphasis:{lineStyle:{width:4}},categories:i,nodes:n,edges:l}],color:this.color}},_legends(){const{nodes:e,legends:t,categoryOther:o,sortLegends:r}=this;if(!e||!e.length)return[];let s;return t?s=t:(s=[...new Set(e.map(({category:e})=>e).filter(e=>a.isNotEmpty(e)&&e!==o))],r&&s.sort((e,t)=>e.localeCompare(t))),[...s,o]},categories(){return this._legends.map(e=>({name:e}))},_nodes(){const{nodes:e,edges:t,_legends:o,search:r={},maxNodeOpacity:s,minNodeOpacity:i,getNodeSize:n,getNodeOpacity:l,nodeLabelVisibleDegree:d,nodeVisibleDegree:c}=this,p=new Map;return e.filter(({name:e})=>!p.has(e)&&p.set(e,1)).map((e={})=>{const c=Math.max(t.reduce((t,{source:o,target:a})=>(e.name===o||e.name===a)&&t+1||t,0),1),p=o.findIndex(t=>t===e.category),{keyword:u}=r;let h,y={};return a.isNotEmpty(u)?e.name.includes(u)?(h={color:"#3eaf7c",shadowColor:"#3eaf7c",opacity:s},y={color:"#3eaf7c"}):h={opacity:i}:h={opacity:l(c)},{...e,value:c,category:p>=0?p:o.length-1,symbolSize:n(c),itemStyle:h,label:{...y,show:c>=d}}}).filter(({value:e})=>e>=c)},_edges(){const{edges:e,linkEdgeColor:t}=this;return e.map(e=>({...e,value:e.predicate||"-",lineStyle:{color:e.link&&t}}))},keywords(){const{nodes:e,search:t={}}=this,{keyword:o}=t;return a.isEmpty(o)?[]:e.map(({name:e})=>e).filter(e=>e.includes(o))}},methods:{getNodeSize(e){const{minNodeSize:t,maxNodeSize:o,nodeSizeStep:a}=this;return Math.min(t+(e-1)*a,o)},getNodeOpacity(e){const{minNodeOpacity:t,maxNodeOpacity:o,maxNodeOpacityDegree:a,nodeOpacityIndex:r}=this;return Math.min(t+Math.pow(e/a,r)*(1-t),o)},onClick({data:e={}}={}){const{link:t}=e;t&&this.$router.push(t)},handleKeywordInput(e){this.search.timer&&clearTimeout(this.search.timer),this.search.timer=setTimeout(()=>{this.search.keyword=e.target.value},300)},handleKeywordBlur(){setTimeout(()=>{this.search.showOptions=!1},100)}}},i=(o(531),o(17)),n=Object(i.a)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"knowledge-graph",style:`width: ${e.width}; height: ${e.height};`},[t("responsive-echarts",{attrs:{option:e.option,loading:e.loading},on:{click:e.onClick}}),e._v(" "),t("div",{staticClass:"search-tool"},[t("div",{staticClass:"item"},[t("label",[e._v("关键字")]),e._v(" "),t("div",{staticClass:"content"},[t("div",{ref:"select",staticClass:"input"},[t("input",{attrs:{type:"text"},domProps:{value:e.search.keyword},on:{input:e.handleKeywordInput,focus:function(t){e.search.showOptions=!0},blur:e.handleKeywordBlur}}),e._v(" "),t("ul",{directives:[{name:"show",rawName:"v-show",value:e.search.showOptions,expression:"search.showOptions"}],staticClass:"options"},e._l(e.keywords,(function(o){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.keywords.length,expression:"keywords.length"}],staticClass:"option",on:{click:function(t){t.stopPropagation(),e.search.keyword=o}}},[e._v("\n              "+e._s(o)+"\n            ")])})),0)])])])])],1)}),[],!1,null,"4d21b136",null);t.default=n.exports}}]);